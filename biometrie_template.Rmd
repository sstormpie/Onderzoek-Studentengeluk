---
title: "Biometrie onderzoek"
authors: "Storm Steller, Jarno Duiker"
date: "`r Sys.Date()`"
output:
  html_document:
    css: style.css
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

```{r setup, include=FALSE}
# DON'T TOUCH THIS
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

```


## Inleiding

Voor dit onderzoek hebben wij van 40 personen, 20 mannen en 20 vrouwen, zowel de lengte als de breedte van de hand gemeten om te kijken of er gemiddeld een verschil zit tussen de grootte van de hand tussen man en vrouw.




:::attention
### Onderzoeksvraag
> Wat is het verschil in handgrootte tussen de twee sexen?
:::


:::attention
### Hypothse
> De mannelijke hand is gemiddeld groter dan de vrouwlijke hand.
:::


:::attention
### Nulhypothese
> Het verchil in handgrote tussen de twee sexen in nihil.
:::


## Ontwerp van het experiment

Van 40 proefpersonen, waarvan 20 mannen en 20 vrouwen, meten we zowel de lengte als breedte van hun handen. De meetresultaten slaan we op in een excel document om er vervolgens naar te kijken met grafieken die de lengte, breedte en ratio laten zien. Daaruit kunnen wij een conclusie trekken op onze onderzoeksvraag.


:::protocol
### Protocol voor meting handlengte en handbreedte
**Meetprotocol:**
meet de lengte en breedte van de hand bij 40 mensen (in millimeters)
 
**Breedte: **
Laat de persoon de arm (vanaf de elleboog) plat op de tafel leggen, met de wijsvinger tot pink bij elkaar, dus met de duim gespreid. Meet vanaf de knokkel van de wijsvinger tot aan de knokkel bij de pink.
 
**Lengte:** laat de persoon de arm (vanaf de elleboog) plat op de tafel leggen, met de vingers bij elkaar. Meet vanaf de langste vinger tot aan het bot aan de buitenste zijde van de pols.

##### **Benodigdheden**

1. Meetlat, schuifmaat of meetlint.  
2. Spreadsheet om resultaten vast te leggen, met toegang hiertoe op locaties zonder internet-toegang.  
3. Je laborant-ID: een unieke _identifier_ die jou als onderzoeker identificeert. Neem hiervoor de laatste 4 cijfers van je studentnummer.

##### **Data verzamelen**

Zoek, samen met een ander groepje van je klas, in of rond het schoolgebouw medestudenten. Vraag beleefd of ze willen participeren in een klein wetenschappelijk onderzoekje voor school waarbij de maten van de hand opgenomen zullen worden.  
Is het antwoord nee, dan groet je vriendelijk en zoek je verder.  
Is het antwoord ja, dan vraag je of de proefpersoon de hand horizontaal en gestrekt wil houden met de palm naar beneden. Vervolgens meet je zowel de lengte als de breedte van de hand op, in millimeters. Deze leg je vast in de spreadsheet, samen met je laborant-ID en een identifier (géén naam!) van de proefpersoon. Ten slotte vraag je aan de proefpersoon zijn/haar/hun sexe en legt deze vast. Wil de proefpersoon deze niet geven, of is die nonbinair, dan leg je dit vast als "anders/onbekend". Het "parallel groepje" (dat niet jouw bevindingen mag horen) doet dezelfde meting en slaat deze met dezelfde participant identifier op.  
Bedank de proefpersoon voor deelname.  
Wissel de metingen af tussen de verschillende studenten in jouw groepje.

Ga door totdat van voldoende proefpersonen de gegevens zijn verzameld.
:::


## Analyse

:::attention
De data is opgeslagen in het format hieronder:  

<pre>
laborant_ID,subject_ID,handlengte,handbreedte,sexe
</pre>

Voorbeeld:

<pre>
3241,G1_03,113,104,m
</pre>
:::

### Data inlezen

```{r demo-data-inlees}
data_file <- "handdata.csv"

#data format: laborant_ID,subject_ID,handlengte,handbreedte,sexe
biometric_data <- read.table(file = data_file,
                        header = TRUE,
                        sep = ",")

```


### Beschrijvende statistieken


```{r}
## Ratio toevoegen 
biometric_data$ratio <- biometric_data$handlengte / biometric_data$handbreedte
head(biometric_data)
```

Hierboven is een voorbeeld te zien van hoe de data is gestructureerd.

```{r}
## Gemidelden per sexe

# tapply(X = biometric_data$handlengte,
#        INDEX = biometric_data$sexe,
#        FUN = mean)

#Split over gender in een lijst van dataframes
sexe_split_data <- split(x = biometric_data,
                         f = biometric_data$sexe)

#Functie toepassen om de gemiddelde metingen weer te geven
sapply(X = sexe_split_data, 
       FUN = function(x){
           c(handlengte = mean(x$handlengte),
             spreiding_lengte = sd(x$handlengte),
             handbreedte = mean(x$handbreedte),
             spreiding_breedte = sd(x$handbreedte),
             ratio = mean(x$ratio))
       })
```

Hierboven is een kleine tabel te zien met de gemiddeldes en spreidingen van de metingen. De data is opgedeeld in 2 categorieën, man en vrouw. Aan de hand van deze tabel alleen al kan je zien dat de hand van een man gemiddeld groter is dan die van een vrouw, maar toch gaan we dit op andere manieren bekijken.


```{r}
#plot voor handbreedte tussen de sexe
ggplot(data = biometric_data,
       mapping = aes(x = sexe, y = handbreedte, fill = sexe)) + 
    geom_boxplot() +
    geom_point() +
    labs(x = "Sexe", y = "handbreedte (mm)") +
    theme_minimal()
```

```{r}
#plot voor handbreedte tussen de sexe
ggplot(data = biometric_data,
       mapping = aes(x = sexe, y = handlengte, fill = sexe)) + 
    geom_boxplot() +
    geom_point() +
    labs(x = "Sexe", y = "handlengte (mm)") +
    theme_minimal()
```
```{r}
## histogram

ggplot(data = biometric_data,
       mapping = aes(x = ratio, fill = sexe)) + 
    geom_histogram(bins = 10, color = "black") +
    facet_wrap(. ~ sexe) +
    labs(x = "lengte/breedte ratio") +
    theme_minimal()
```

In de 3 grafieken hierboven zie je de data uit de tabel. Alle grafieken zijn gesplitst op sexe. De bovenste boxplot laat de verdeling van de handbreedte tussen de sexe zien. De boxplot daaronder laat de verdeling van de handlengte tussen de sexe zien. De histogram laat de verdeling van de ratio tussen de sexe zien. Wat opvalt is dat er in elke grafiek wel minstens een uitschieter zit. 

## Data Bespreken



### Welke verdeling?

Hoe kleiner de steekproefgrootte (_sample size_) hoe lastiger het is de onderliggende verdeling vast te stellen. Speel maar eens met dit blokje code, en verander de steekproefgrootte (`n=`) in de `rnorm()` functie en de `breaks=` in de `hist()` functie. 
Neem voor _n_ bijvoorbeeld achtereenvolgens 10, 100, 1000, 10000, 10000 en voor _breaks_ 5, 10, 50. Wanneer zie je een echte normaalverdeling verschijnen? 

```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 10, fill = "red", colour = "black") +
    theme_minimal()
```

:::attention
**Dit _experiment_ met de argumenten van `rnorm()` en `hist()` moet je opnemen in je eigen RMarkdown.**  
Beantwoord deze vragen:

1. Wat gebeurt er met de vorm van de verdeling als `n` groter wordt?\
   A: De vorm is steeds meer even en lijkt op een hele egale normaal verdeling
2. Wat gebeurt er met de spreiding van de data (x-as) als `n` groter wordt, en kan je dat verklaren?\
    A: Als N groter wordt, wordt de spreiding van de x as ook groter. N is steekproef groote wanneer deze        groter is geeft dit meer resultaten waar meer verschillen in kunnen zitten dus krijg je een              bredere x as
3. Waarom is bij zelfde instellingen voor `n` en `breaks` de uitkomst toch verschillend?\
    A: Omdat bij N de steekproef omgang bepaald wordt en bij breaks kies je hoeveels bin's je het opdeeld
4. Welke minimale `n` geeft het meeste kans om een echte normaalverdeling te zien?\
    A: wij hebben bevonden dat 100 het minimale is om op oogopervlak te zien dat het een normaal                verdeling is
5. Wat voor bijzonders is er aan de hand met het `breaks` argument? Geeft de documentatie daar een verklaring voor?\
    A: Het heet bin inplaats van break,  
:::

### Bronnen van variatie

Tot nu toe hebben we alleen maar gekeken naar de biologische variatie, de verschillen tussen man en vrouw. Dus is het tijd om te kijken naar de experimentele variatie. Dat is net zo belangrijk als de biologische variatie. Het is belangrijk om het onderzoek reproduceerbaar te maken. Invloed op de experimentele variatie kan bijvoorbeeld het meetinstument zelf zijn. Lang niet alle linialen op aarde zijn precies hetzelfde gefabriceerd.

ONDERZOEK BRONNEN VAN VARIATIE
BESPREEK DIT KORT
```{r}
#plot voor handbreedte tussen de sexe

#deze functie zorgt ervoor dat we een nieuwe colom maken met id's veranderd van een int naar een str
biometric_data$lab_as_string <- as.character(biometric_data$laborant_ID)

ggplot(data = biometric_data,
       mapping = aes(x = lab_as_string, y = handlengte, fill = lab_as_string)) + 
    geom_boxplot( colour = "black") +
    theme_minimal()
```

De bovenstaande  boxplot geeft de meetwaarden voor handlengte uitgesplitst op laborant_ID. Er is hier mogelijk sprake van een systematische bias. Laborant 8413 heeft schijnbaar consequent een kleinere lengte gemeten dan laborant 1047.

```{r}
ggplot(data = biometric_data,
       mapping = aes(x = sexe, y = handbreedte)) +
    geom_boxplot(fill = "pink") +
    facet_wrap(. ~ lab_as_string) +
    ylab("Handbreedte (mm)") +
    theme_linedraw()
```

In de bovenstaande boxplot zie je hetzelfde als de boxplot erboven, maar dan met de sexe ook gesplitst. Hier zie je twee bronnen van variatie. Systematiscche bias die waarschijnlijk is veroorzaakt door de laboranten en de biologische variatie tussen man en vrouw.

### De hypothese aannemen?

```{r}
shapiro.test(biometric_data$ratio)
```

```{r}
vrouw_ratio <- subset(biometric_data,
                      subset = sexe == "v",
                      select = ratio,
                      drop = T)
man_ratio <- subset(biometric_data,
                      subset = sexe == "m",
                      select = ratio,
                      drop = T)
t.test(vrouw_ratio,man_ratio)
```

```{r, include=FALSE}
wilcox.test(vrouw_ratio,man_ratio)
```



## Reflectie op het experiment

:::info
Bespreek in je groep de volgende vragen en voeg de antwoorden toe aan je uitgewerkte onderzoeksdocument.  

1. Zijn de metingen tussen de verschillende meters ook (significant) verschillend? Zo ja, waardoor zou je de verschillen kunnen verklaren?

Er is een klein verschil tussen de twee meters. Dit zou kunnen doordat ze de start plaats van de pols anders hebben geïnterpreteerd. 

2. Onderzoek de verschillen tussen mannen en vrouwen met betrekking tot hand lengte, handbreedte en de ratio.

Aan de hand van de resultaten van het onderzoek kunnen we concluderen dat mannen gemiddeld een grotere hand hebben, zowel in de lengte als breedte. Het lengte/breedte ratio is echter bijna even groot tussen de sexe.

3. Zou je het protocol aanpassen na deze ervaring, of was hij voldoende duidelijk en reproduceerbaar?

Om nog een duidelijker protocol te maken zou er een voorbeeld foto kunnen worden toegevoegd ( of video ) van de meet wijze zodat deze exact kan worden gerepliceerd 
:::


:::attention
#### Wat je moet inleveren
Voor de verwerking en analyse van je eigen data maak je gebruik van het aangeleverde template RMarkdown document. Daarin doorloop je dezelfde onderzoek stappen als hieronder, maar dan met je eigen data. Aan het einde van de dag gaat dat document, in originele en "geknitte" vorm, samen met je databestand, in een git repo die is opgezet volgens voorschift in de cursushandleiding. De link hiernaar toe gaat in je portfolio op eJournal. Let op dat je _alle_ stappen hebt doorlopen voordat je inlevert. Gebruik ook de RStudio spellingscontrole!  
Vergeet niet jullie namen en studentnummers bovenaan de markdown te zetten!
:::
