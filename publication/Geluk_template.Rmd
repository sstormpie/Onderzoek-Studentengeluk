---
title: | 
    Welke studenten stad heeft de gelukkigste studenten?

author: |
  | Storm Steller $^1$, Jarno Jacob Duiker $^1$, 
  | $^1$Student Bio-informatics 1st year $^1$ Hanze Honours $^1$ Faculty of Life sciences $^1$ Hanze UAS

lang: nl # dit zorgt er voor dat "abstract" "samenvatting" gaat heten

abstract: | 
    Dit onderzoek gaat over het geluk van studenten in verschillende studenten steden. De steden die wij hebben onderzocht zijn: Amsterdam, Groningen, Leiden en Utrecht. We hebben in dit onderzoek een enquête gebruikt om data te verzamelen. Dit onderzoek is belangrijk omdat mentale gezondheid onder de studenten tegenwoordig veel in het nieuws is. Geluk is een groot deel van iemands mentale gezondheid daarom is het interessant om te weten in welke stad voor de studenten geluk het hoogste ligt. De factoren die in dit onderzoek worden gebruikt gaan van persoonlijk naar omgevingsfactoren zodat er een duidelijk beeld kan worden geschetst waarin ook langdurige problemen worden meegenomen die invloed hebben. 


bibliography: Geluk_template.bib # naam van je .bib file. Deze moet hetzelfde zijn als je Rmd bestandsnaam

output:
  bookdown::pdf_document2:
    keep_tex: false    # set this to true if you want to investigate the generated tex
    toc: false         # table of contents
    fig_caption: true  # includes figure captions with numbering in output
    includes:  
        in_header: include_tex_header.tex #will include rules for linespacing and figure floating
---


```{r setup, message=FALSE, warning=FALSE, include=FALSE }
knitr::opts_chunk$set(out.width = '100%', dpi=300) # configuratie voor figuur grootte en resolutie
knitr::opts_chunk$set(echo = FALSE) # Deze regel zorgt ervoor GEEN ENKELE chunk getoond wordt! 
# Laad alle gebruikte bibliotheken hier
library(knitr)
library(ggplot2)
library(fmsb)
library(tidyverse)
library(dplyr)
```


# Introductie

Waarom dit onderzoek? Dit onderzoek is er om te kijken of er verschil zit in het geluk tussen verschillende studenten steden. Dit is belangrijk omdat het geluk van een persoon invloed kan hebben op verschillende factoren in zijn leven. Als we kijken naar Geluk omvat dit meerdere dingen. Een persoon kan heel gelukkig worden van een academische prestatie echter zijn er anderen die meer geluk halen uit een sociale ontmoeting. Deze verschillende factoren zijn in ons onderzoek gemeten. Hiervoor is literatuur gebruikt die diep in gaat op wat mensen door de jaren heen van geluk maakten, De paper van Veenhoven, R. (1991, 1 januari). Questions on Happiness kijkt hier naar in verschillende tijdperken. Verder zijn er bepaalde factoren naar boven gekomen die belangrijk zijn voor een mens wanneer het gaat over het meten van geluk.\

Sekse, als er gekeken wordt naar het menselijk lichaam is er te zien dat er een verschil is tussen de mannelijke en vrouwelijke sekse in specifiek de hormonen. Dit heeft invloed op hoe geluk wordt ervaart. Wanneer een vrouw haar menstruatie ervaart kan deze een kort effect hebben op hoe gelukkig deze zich voelt. Hier heeft een man echter geen last van.\

Niveau van de opleiding, Het is algemeen bekend dat mensen die een hoger opleiding doen vaker ongelukkiger zijn door mentale complicaties. Dit is niet te zeggen dat studenten van een lager niveau hier geen last van hebben echter is het een goede factor om te bekijken.\

Welk jaar de student in zit, Wanneer iemand al meerdere jaren heeft gestudeerd zal deze een andere kijk hebben op het effect van de omgeving van zijn studentenstad. Hierdoor is een 1ste jaar student te vergelijking met een 3de jaar student interessant. Het zou kunnen zijn dat een student namelijk aan zijn stad went.\

Vakgebied, De omgeving van een studie hangt af van iemands vakgebied. Wanneer een student een sociale studie doet zoals bedrijfskunde of social-work, Wordt deze in een omgeving gezet met andere studenten die over het algemeen ook socialer zijn. In een technische opleiding zijn studenten over het algemeen meer teruggetrokken. Dit zou dus ook invloed hebben op een student en wat voor prioriteiten deze heeft.\

Woonsituatie (Uitwonend vs Thuiswonen), In het geval dat een student thuis woont zou deze wanneer het wordt gecombineerd met een slechte relatie met zijn ouders een langdurig effect kunnen hebben op zijn geluk en hoe deze verder zich mentaal voelt.\

Geloving (Ja of Nee), Het is bekend dat mensen die gelovig zijn veel rust en mentale support halen uit hun geloof. Dit doen ze door het lezen van hun geloof gerelateerde literatuur en deze op hun eigen leven toe te passen. Het kan ook zijn dat de persoon steun haalt uit zijn omgeving met andere gelovigen.\

Relatie (Ja of Nee), Het hebben van een partner kan goed en slecht zijn voor iemands geluk. Wanneer de relatie met deze persoon in een goede staat verkeerd zal deze persoon steun, support en andere postieve dingen naar iemands leven brengen. Wanneer deze in een slechte of verslechterende situatie verkeerd zal deze stress en ongelukkig heid brengen naar iemands situatie.

**factoren in de vragen**

Fysieke gezondheid\

Mentale gezondheid\

Relatie met ouders\

Sociale gezondheid\

Geld / financiele situatie\

Drugs en/of alcohol gebruik\

Er zijn eerder onderzoeken gedaan naar het geluk van jong volwassenen, ook zijn er onderzoeken geweest naar het geluk van studenten. Deze onderzoeken zijn echter niet heel diepgaand en focussen meer op het algemene geluk gevoel. Ons onderzoek gaat ook in op factoren die langdurig effect zouden hebben op iemands geluk. Ondanks dat ons onderzoek wat dieper in gaat op deze factoren zal deze alsnog niet diep genoeg zijn. In ons onderzoek wordt alles becijferd met een 0-10 schaal deze kan duidelijker worden wanneer de student zijn eigen mening er in kan zetten. Dit is voor ons in het tijd frame wat wij hebben niet mogelijk. De technieken die wij hebben gebruikt zijn een enquête die via een poster kan worden geopend en email's die de link bevatten die verwijzen naar de enquête.\

**Doelstelling**\

Op een grafische wijze laten zien wat het gemiddelde geluk is van de studenten in de verschillende steden.\

Kijken wat de verschillen zijn wanneer we naar de factoren kijken en hier de groepen met elkaar vergelijken.\

antwoord geven op de hypthose.\

Deze doelstellingen willen wij bereiken door studenten in de verschillende studenten steden een enquête laten in te vullen. Hier de data uit te halen en deze verwerken met R. Van deze verwerkte data grafieken maken waar de data netjes is uit te lezen. Hierdoor kunnen de vragen en hypothese worden beantwoord.\

De hypothese die wij willen be antwoorden is: Het maakt voor het geluk van de student niet uit in welke stad deze studeert.

# Materialen en Methoden

## Materialen

| Tool               | Referentie                                                | Versie                               | Waarom                                                                                                                                                                                       |
|-----------------|-----------------|-----------------|----------------------|
| Google forms       | <https://docs.google.com/forms/>                          |                                      | Gebruikt om een enquête te maken die gebruikers vriendelijk is en een netjes csv bestand geeft als output.                                                                                   |
| Git                | <https://www.git-scm.com>                                 | git version 2.44.0                   | Git wordt gebruikt voor version control                                                                                                                                                      |
| Github             | <http://github.com>                                       |                                      | De gehele data set, logboeken en protocol staan op github omdat dit een netjese en goed navigeerbare omgeving maakt zodat iemand ook alles in 1 keer kan downloaden en bekijken.             |
| RStudio            | <https://posit.co/download/rstudio-desktop/>              | Versie 2023.12.1+402 (2023.12.1+402) | Dit programma gebruiken we om ons RMarkdown document te maken wat uiteindelijk ons eindproduct is geworden.                                                                                  |
| R                  | <https://www.r-project.org>                               | R version 4.3.3 (2024-02-29)         | R staat mensen toe om vaardig grote hoeveelheden gegevens te verwerken, publicatie-waardige visualisaties te genereren, en een reeks statistische en analytische computertaken uit te voeren |
| fmsb               | <https://cran.r-project.org/web/packages/fmsb/index.html> | 0.7.6 (03-06-2024)                   | Wij gebruiken deze voor het maken van radar plots                                                                                                                                            |
| ggplot2            | <https://ggplot2.tidyverse.org>                           | 3.5.1 (03-06-2024)                   | Deze package wordt om plotjes in dit document duidelijker en netjeser te maken                                                                                                               |
| pwr                | <https://github.com/heliosdrm/pwr>                        | 1.3-0 (October 14, 2022)             | per wordt gebruikt om statistische analyze te doen zoals een t test                                                                                                                          |
| dplyr              | <https://dplyr.tidyverse.org>                             | 1.1.4 (03-06-2024)                   | dplyr geeft andere commando's die niet in de standaard versie van R zit.                                                                                                                     |
| knitr              | <https://yihui.org/knitr/>                                | knitr 1.47 (03-06-2024)              | Knitr is gebruikt om dingen aan te passen die in de geknitte versie komen                                                                                                                    |
| tidyverse          | <https://www.tidyverse.org>                               | tidyverse 1.3.0 (03-06-2024)         | Tidyverse wordt gebruikt om verschillende dingen aan te passen in potjes                                                                                                                     |
| Canva              | <https://www.canva.com>                                   |                                      | Canva is gebruikt om posters te maken met qr codes die de enquete openen                                                                                                                     |
| Google Spreadsheet | <https://docs.google.com/spreadsheets/>                   |                                      | De antwoorden van de Google forms worden hier in een spreadsheet gezet en deze kan via een download knop omgezet worden in een csv file.                                                     |
| Mendeley refrence manager   	| [https://docs.google.com/forms/ ](https://www.mendeley.com/reference-management/reference-manager/)    |   2.112.2                     	| Gebruikt om een alle literatuur netjes te ordenen en goed te refereren
## Methoden

### Het meten van geluk

Om het geluk van de studenten te meten hebben wij een enquête gemaakt met verschillende vragen over geluk. Dit hebben wij gekozen, omdat het na een literatuuronderzoek ons het meest geschikt leek voor het meten van geluk. In deze enquête worden er naar meerdere onderwerpen gevraagd: sexe, de stad waarin de persoon studeert, financiele situatie, gebruik van verdovende middelen, geloof, de band tussen de student en hun ouders, of de student thuis woont of op hunzelf, of ze in een relatie zitten, fysieke gezondheid, contact buiten school en academische prestaties. Deze zijn op te delen in parameters en factoren. De parameters in dit geval zijn:

| Parameter                                       | Verdeling                                                                 |
|-----------------------------|-------------------------------------------|
| Sexe                                            | Opgedeeld in Man, Vrouw en Anders                                         |
| Niveau van de opleiding                         | Opgedeeld in MBO, HBO, Masters en Universiteit                            |
| Welk jaar de studenten in zitten                | Opgedeeld in jaar 1, 2, 3 en 4                                            |
| Vakgebied                                       | Opgedeeld in sociaal, technisch, kunst, lifeciences, economisch en anders |
| Woonsituatie                                    | Opgedeeld in uitwonend of thuiswonend                                     |
| Welke stad ze studeren                          | Opgedeeld in Groningen, Leiden, Utrecht en Amsterdam                      |
| Gelovig                                         | Opgedeeld in gelovig en niet gelovig                                      |
| Relatie                                         | Opgedeeld in relatie en single                                            |
| Gebruik van verdovende middelen                 | Opgedeeld in ja en nee                                                    |
| Of ze nationaal- of internationale student zijn | Opgedeeld in nationaal en internationaal                                  |

Dit zijn de gekozen parameters, omdat wij vinden dat deze allemaal invloed op het geluk kunnen hebben. De rest van de vragen zijn de factoren waarbij we het geluk meten.\

Om de enquête zelf te maken hebben wij Google forms gebruikt, omdat het makkelijk is om de data in een .csv formaat te krijgen vanuit Google forms.

### Het verzamelen van de data

Om onze enquête te verspreiden hebben wij ervoor gekozen om een poster met een Qr code te maken. Deze poster hebben wij gemaakt met Canva, omdat het makkelijk te gebruiken is. Op de poster staat er of de persoon die deze leest de enquête wilt invullen. Omdat wij zowel nationale- als internationale studenten willen meenemen, hebben wij een Nederlandstalige en een Engelstalige poster gemaakt. Op die manier kan iedereen de poster lezen.\

Deze poster zouden wij vervolgens verspreiden door verschillende schoolgebouwen rondom de campussen van de verschillende steden. Op deze manier kunnen de studenten die de poster tegenkomen makkelijk bij de enquête komen en die invullen.\

Naast het ophangen van de posters hebben wij ook besloten om de poster te verspreiden via e-mail. Wij stuurden een e-mail naar alle MBO scholen, HBO scholen, Universiteiten, en alle studieverenigingen in de verschillende steden met de vraag of ze onze enquête willen invullen en verspreiden. In de mail werd een pdf bestand in de bijlage gezet met de poster en werd een link in de mail gezet die naar de enquête leidt. Hier hebben wij voor gekozen, omdat wij vonden dat wij op deze manier veel meer studenten konden bereiken.\

Als laatst hebben wij de enquête ook verspreid over verschillende LinkedIn groepen die horen bij de schoolorganisaties. In de groepen werd een bericht gestuurd die hetzelfde is als de e-mails die we hebben verstuurd. Ook hiervoor hebben we gekozen, omdat we vonden dat wij op dez manier meer studenten konden bereiken.

### Analyse van de data
Om onze data te analyseren hebben wij verschillende libraries gebruikt. De namen van de libraries staan in het stukje materialen. Deze libraries hebben wij gebruikt voor verschillende dingen. We hebben de libraries gebruikt om tests te runnen. We hebben tests gerund om te kijken of onze data betrouwbaar en normaal verdeeld is. Daarna hebben wij de libraries gebruikt om verschillende grafieken te maken. De grafieken die we hebben gemaakt zijn histogrammen, boxplots, radar charts, en pie charts. Deze hebben wij gekozen, omdat ze onze data op een goede manier laten zien. Met deze tests en grafieken hopen wij onze vraag te beantwoorden.


# Resultaten

```{r, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}

Student_awn_data <- read.csv("../raw_data/Student_hap_awn_30_05.csv")

colnames(Student_awn_data) <- c("Tijd", "Sekse", "Niveau", "Opl_jaar","Vakgebied", "Woonsituatie", "Stad", "Nat_Int", "Gelovig", "Relatie_stat", "Happy_RN", "Fys_Happy", "Fys_import", "Cont_buiten_school", "Na_school_soc", "Ouder_relatie", "Woonsituatie_geluk", "Thuis_in_stad", "academische_pres", "Financiele_sit", "Geld_geluk", "Verd_mid_gebr", "drugs_alc_geluk", "Mental_health", "Happy_after_quest")
```

```{r, echo=FALSE}
#Maak een aparte vector met alle numerieke data
numerieke_data <- select(Student_awn_data, c(11:15, 17:21, 23:25))
```

Om eerst te kijken hoe onze data verspreid is, rekenen we het gemiddelde, 95% betrouwbaarheidsinterval en de standaard deviatie uit voor elk stuk numerieke data.

```{r BI95, echo= FALSE}
#Deze functie berekent het gemiddelde binnen de 95% betrouwbaarheidsinterval
mean_BI <- function(lijst) {
    y_av <- mean(lijst)
    s <- sd(lijst)
    n <- length(lijst)
    s_av <- s / sqrt(n)
    BI <- y_av + qt(c(0.025, 0.975), n-1) * s_av
    
    (cat(sprintf("Gemiddelde = %.1f, 95%% BI = [%.1f, %.1f] SD = %.1f\n", y_av, BI[1], BI[2], s))
)
}

#Maak een lijst van de numerieke data
list <- as.list(numerieke_data)

#Bereken het gemiddelde binnen de 95% betrouwbaarheids interval van alle factoren
c <- 1
for (i in list) {
  print(colnames(numerieke_data[c]))
  mean_BI(i)
  c <- c + 1
}

```

Zoals je hierboven ziet, is de data best wel verspreid. De gemiddelde standaard deviatie van de data is ongeveer 2. Dit is best hoog, omdat onze data op schaal van 1-10 is.\


Om te kijken of onze data normaal verdeeld is, kunnen we een histogram maken:

```{r , fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}

ggplot(numerieke_data, 
       aes(x = Happy_RN )) +
    ggtitle("Algemeen Geluk Studenten") +
    ylab("Frequentie (Aantal Personen)") +
    xlab("Algemeen Geluk") +
    geom_histogram(bins= 20, binwidth= 0.7) +
    labs(caption = "Figuur 1: Algemeen Geluk Studenten ") +
    theme("minimal")
```

De histogrammen die uit onze data komen zijn echter niet overzichtelijk. Dit komt hoogstwaarschijnlijk vanwege een tekort aan respondenten. Maar als je alleen naar de grafiek zou kijken, kan je wel zeggen dat de data normaal verdeeld is. We gaan echter wel wat meer doen om te kijken of dat daadwerkelijk zo is.\

### Shapiro Wilcoxon Test

Om goed te kijken of onze data normaal verdeeld is, voeren we een shapiro wilk test uit. Uit deze test krijgen we een p-waarde en een t-waarde. Als de p-waarde \>0.05 is, betekent dat dat onze data normaal verdeeld is.

```{r shapiro test, echo=FALSE}
#Voer een shapiro test uit op alle kolommen in de dataframe
shapiro_test_data <- as.character(sapply(numerieke_data, shapiro.test))

#Haal de onnodige informatie uit de vector
shapiro_test_data <- shapiro_test_data[! shapiro_test_data%in% c("Shapiro-Wilk normality test",  "X[[i]]")]

#Maak een nieuwe dataframe aan
df_shapiro = data.frame(
  col1= character(), 
  col2= character(), 
  stringsAsFactors = FALSE)
 
#Een counter voor de indexing
c <- 1

#Voeg rijen toe aan de dataframe
for(i in 1:13) {                       
   
  #Maak een vector aan die in het dataframe komt
  vec <- c(shapiro_test_data[c], shapiro_test_data[c+1])     
  
  #Voeg de vector toe aan de rij
  df_shapiro[i, ] <- vec
  
  #Voeg 2 toe aan de counter
  c <- c +2
}

df_shapiro <- data.frame(t(df_shapiro))

rownames(df_shapiro) <- c("t-statistic", "p-waarde")

colnames(df_shapiro) <- colnames(numerieke_data)

df_shapiro
```

Hierboven zie je de shapiro wilk test uitgevoerd op alle numerieke data. Als je alle kolommen in de rij van de p-waarde af gaat, kan je zien dat geen enkele p-waarde \>0.05 is. Dit betekent dat onze data niet normaal verdeeld is. Dit dat onze data niet normaal verdeeld is. Deze p-waarden vertellen ons ook dat wij onze hyphothese moeten afwijzen, wat betekent dat er geen effect is. Dit is jammer, maar we kunnen ondanks dit nog wel naar andere onderwerpen kijken.

```{r, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}
Reactie_stad <- select(Student_awn_data, c(Stad))

ggplot(Reactie_stad, aes(x = " ", y = "Antwoord per stad", fill = Stad)) +
    geom_col() + 
    coord_polar(theta = "y") +
    scale_fill_brewer() +
    labs(caption = "Figuur 2: Antwoord per stad") +
    ggtitle("Antwoord per stad", subtitle = "Utrecht heeft geen antwoorden deze is hierdoor niet zichbaar") +
    theme_void()
```

In deze grafiek is te zien dat op 4 antwoorden na alle antwoorden uit Groningen komen. Hierdoor is het voor ons niet mogelijk om de hypothese te beantwoorden. Deze hypothese klinkt: “Het maakt voor het geluk van de student niet uit in welke stad deze studeert.” Dit valt met de data die is verkregen niet te beantwoorden. Hierdoor kan er alleen naar het geluk onder de studenten in Groningen worden gekeken.

De verzamelde data in Groningen komt neer op 73 studenten. In deze steekproef groep zitten ook verschillen. Deze verschillen zijn ook interessant om te bekijken en te benoemen.

Door het gebrek aan data van de andere steden zijn de volgende grafieken en discussies alleen gefocust op de studenten in Groningen. De steden Amsterdam, Leiden en Utrecht worden achterwegen gelaten.

Groningen Als studenten stad heeft de Rijks Universiteit Groningen, Hanze (Hanze University of Aplied Sciences) en verschillende mbo-opleiding. Deze zijn allemaal benaderd met emails en of posters zijn hier opgehangen.

```{r, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}

student_awn_gro <- subset(Student_awn_data, Stad == "Groningen")
student_niveau_gro <- select(student_awn_gro, c(Niveau))

ggplot(student_niveau_gro, aes(x = " ", y = "Opleidngs niveau", fill = Niveau)) +
    geom_col() + 
    coord_polar(theta = "y") +
    scale_fill_brewer() +
    labs(caption = "Figuur 3: Antwoord per niveau") +
    ggtitle("Antwoord per niveau") +
    theme_void()

```

Er is hier te zien dat er een mix is van verschillende opleidings niveau's waar het grootste deel van de antwoorden van HBO studenten komt. Dit geeft ons een duidelijk beeld van wat de HBO studenten voelen.

We hebben daar in tegen wel bepaalde factoren getest die invloed hebben op mensen hun geluk. Hierdoor kunnen we wel zien wat in de geteste groepen invloed heeft op de studenten hun geluk.

Verder Kunnen wij ook kijken naar verschillen voor en na onze enquete en het gemidelde geluk.

```{r plot-with-untidy-data, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}

gem_geluk <- Student_awn_data %>%
    mutate(average_col = Happy_RN + Happy_after_quest)

gem_geluk <- gem_geluk %>%
    mutate(average_col = average_col / 2)

gem_geluk <- select(gem_geluk, c(Sekse, average_col))

ggplot(gem_geluk, aes(x = Sekse, y = average_col, fill = Sekse)) + 
    stat_boxplot(geom = "errorbar",
               width = 0.25) +
    geom_boxplot() +
    ylab("Gemiddelde geluk") +
    xlab("Sekse") +
    labs(fill = "Sekse")+
    labs(caption = "Figuur 4: Het gemidelde geluk per Sekse") +
    ggtitle("Het gemidelde geluk per Sekse", subtitle = "Gemeten van 0-10 (Lijn in het vierkant is het gemidelde)") 
    
```

Hier is het gemiddelde geluk per persoon per sekse te zien deze is opgedeeld tussen de sekse. Hieruit is te zien dat mannelijke studenten over het algemeen gelukkiger zijn dit is te zien aan de Q1-Q3 block deze zit van de 3 sekse het hoogste in de grafiek wat betekent dat deze het gelukkigste lijke. De mediaanlijn laat zien dat het gemiddelde van de mannen iets boven de 6 ligt.

Bij de vrouwen is er te zien dat deze Q1-Q3 kleiner is dan die van de mannen, wat betekent dat vrouwen het meer met elkaar eens zijn over het gemiddelde. Ook is te zien dat er een uitschieter is naar beneden deze vrouw haar geluk ligt onder de 2.5 punten.

Anders is het meest ongelukkigste. Dit is te zien aan de mediaan deze ligt precies op de 5 punten wat volgens het gemiddelde becijferings methoden als onvoldoende wordt beschouwt.

```{r, echo=FALSE}

gem_geluk <- Student_awn_data %>%
    mutate(average_col = Happy_RN + Happy_after_quest)

gem_geluk <- gem_geluk %>%
    mutate(average_col = average_col / 2)

gem_geluk <- select(gem_geluk, c(Sekse, average_col))

df_geluk_fem <- subset(gem_geluk, Sekse == "Vrouw (Female)")
df_geluk_man <- subset(gem_geluk, Sekse == "Man (Male)")


df_geluk_fem <- mean(df_geluk_fem$average_col)
df_geluk_man <- mean(df_geluk_man$average_col)

df_gem_geluk_sexe <- merge(df_geluk_fem, df_geluk_man)
colnames(df_gem_geluk_sexe) <- c("Geluk_vrouw","Geluk_man")
```

### Thuiswonend vs Uitwonend

```{r, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}
woonsit_df <- select(Student_awn_data, c(Woonsituatie,
                                        Happy_RN,
                                        Thuis_in_stad,
                                        Woonsituatie_geluk,
                                        Happy_after_quest))


woonsit_uit <- subset(woonsit_df, Woonsituatie == "Uitwonend (Away from home)")
woonsit_thuis <- subset(woonsit_df, Woonsituatie == "Thuiswonend (At home)")
p <- ggplot() + 
    geom_point(data = woonsit_thuis, aes(x=Happy_RN, y=Happy_after_quest), color = "red", alpha = 0.6) +
    geom_point(data = woonsit_uit, aes(x=Happy_RN, y=Happy_after_quest), color = "blue", alpha = 0.6) +
    xlim(0, 10) +
    ylim(0, 10) +
    labs(color = "Woonsituatie") +
    xlab("Geluk voor de enquête") +
    ylab("Geluk na de enquête")+
    labs(caption = "Figuur 5: Scatterplot Uit- vs Thuiswonende studenten geluk") +
    facet_wrap(~Woonsituatie) +
    ggtitle("Scatterplot Uit- vs Thuiswonende studenten geluk", subtitle = "Donkerder = meerdere zelfde antwoorden") +
    theme_minimal()

p
```

In figuur 5 is het verschil in het gemiddelde geluk tussen de uitwonende en thuiswonende student te zien. Thuiswonende studenten zijn meer gemiddeld verdeeld echter zijn er 2 uitschieters. 1 die redelijk gelukkig was voor de enquête en na de enquête zich ongelukkig voelt de andere uitschieter is gelukkiger na de enquete.\

Bij de uitwonende studenten is te zien dat het geluk aan de hoge kant ligt. Er zijn weinig antwoorden die onder de 5 punten ligt er is 1 uitschieter die na de enquête ongelukkig is geworden.

### Mogelijke relaties




```{r, include=FALSE}
#Een functie die het gemiddelde van data in een dataframe berekent en er een nieuwe dataframe van maakt
mean_frame <- function(data){
  as.data.frame(t(colMeans(data)))
}
 
#Bereken het gemiddelde van alle numerieke gegevens en zet ze in een apart dataframe
df_means <- mean_frame(numerieke_data)
 
#Maak een naam voor de regel
row.names(df_means) <- "Gemiddeld"
 
#df_means
```

```{r, include=FALSE}
#Een functie die data afrond
round_data <- function(data, digits) {
  nums <- vapply(data, is.numeric, FUN.VALUE = logical(1))
 
  data[,nums] <- round(data[,nums], digits = digits)
 
  (data)
}
 
round_data(df_means, 1)
```


Na het bekijken van een paar radar charts viel er iets op.
```{r}
#Deze functie maakt een mooie radar chart, als parameters neemt de functie data, een kleur en een titel
js_radarchart <- function(data, 
                             color,
                             vlabels = colnames(data),
                             title) {
    radarchart(
        data, axistype = 1,
        #Hier worden de kleuren en de lijntypes van de grafiekdata opgezet
        pcol = color, 
        pfcol = scales::alpha(color, 0.5), 
        plwd = 1, 
        plty = 1,
        #Hier is de opmaak van het rooster van de grafiek
        cglcol = "grey", 
        cglty = 1, 
        cglwd = .8,
        caxislabels = NULL, 
        calcex = .75, 
        #Hier wordt de kleur en grootte van de as labels bepaald
        axislabcol = "black",
        vlcex = .80, 
        vlabels = vlabels,
        title = title,
    )
}
```


```{r, echo=FALSE}
#Zet een maximum- en minimum waarde in voor de grafiek
max_min <- data.frame( Happy_RN = c(10,0),
                       Fys_Happy = c(10,0),
                       Fys_import = c(10,0),
                       Cont_buiten_school = c(10,0),
                       Na_school_soc = c(10,0),
                       Woonsituatie_geluk = c(10,0),
                       Thuis_in_stad = c(10,0),
                       academische_pres = c(10,0),
                       Financiele_sit = c(10,0),
                       Geld_geluk = c(10,0),
                       drugs_alc_geluk = c(10,0),
                       Mental_health = c(10,0),
                       Happy_after_quest = c(10,0)
                      )

#Voeg de sexe kolom terug aan de dataframe
numerieke_data$Sexe <- Student_awn_data$Sekse

#Verander de namen van de waarden om het later makkelijker te maken
numerieke_data$Sexe[numerieke_data$Sexe == 'Vrouw (Female)'] <- "Vrouw"
numerieke_data$Sexe[numerieke_data$Sexe == 'Man (Male)'] <- "Man"
numerieke_data$Sexe[numerieke_data$Sexe == 'Anders (Other)'] <- "Anders"

#Reken de gemiddelden van de individuen gesplitst op sexe
mean_man <- mean_frame(numerieke_data[numerieke_data$Sexe == 'Man', 1:13])
mean_vrouw <- mean_frame(numerieke_data[numerieke_data$Sexe == 'Vrouw', 1:13])
mean_anders <- mean_frame(numerieke_data[numerieke_data$Sexe == 'Anders', 1:13])

#Zet alle gemiddelden in een dataframe met de maximale- en minimale grens
df_mean_sexe <- rbind(max_min, mean_man, mean_vrouw, mean_anders)

#Zet de correcte titels voor de rijen in de dataframe
rownames(df_mean_sexe) <- c("Max", "Min", "Man", "Vrouw", "Anders")

#Rond de waarden in de dataframe af
df_mean_sexe <- round_data(df_mean_sexe, 1)

#Verwijder de sexe kolom weer
numerieke_data <- numerieke_data[1:13]

#head(df_mean_sexe)
```


```{r, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}
op <- par(mar = c(1, 1, 1, 1))

js_radarchart(data= df_mean_sexe, color= c("#4dd5ff", "#f5c2ff", "#e3e655"), title= "Gemiddeld Geluk Gesplitst Op Sexe") 

#Maak een legenda voor de grafiek
legend(
  x = "right", 
  legend = c("Man", "Vrouw", "Anders"), 
  horiz = FALSE,
  bty = "n", 
  pch = 20 , 
  col = c("#4dd5ff", "#f5c2ff", "#e3e655"),
  text.col = "black", 
  cex = 1, 
  pt.cex = 1.5
  )

par(op)
```
In figuur 6 waarin het gemiddeld geluk te zien is van de verschillende sekse. Wat opvalt is dat de groep "Anders" over het algemeen veel minder gelukkig is dan de rest. Ook valt op dat dezelfde groep meer aan drugs en alchohol doet dan de rest. 

```{r, fig.asp=.75, out.width='50%', fig.align='center', fig.cap='Selecting untidy data', echo=FALSE}
#Voeg de Vakgebied kolom terug aan de dataframe
numerieke_data$Vakgebied <- Student_awn_data$Vakgebied

#Verander de namen van de waarden om het later makkelijker te maken
numerieke_data$Vakgebied[numerieke_data$Vakgebied == "Technisch (Technical)"] <- "Technisch"
numerieke_data$Vakgebied[numerieke_data$Vakgebied == "Anders (Other)"] <- "Anders"
numerieke_data$Vakgebied[numerieke_data$Vakgebied == "Sociaal (Social)"] <- "Sociaal"
numerieke_data$Vakgebied[numerieke_data$Vakgebied == "Kunst (Art)"] <- "Kunst"
numerieke_data$Vakgebied[numerieke_data$Vakgebied == "Economisch (Economical)"] <- "Economisch"

#Reken de gemiddelden van de individuen gesplitst op vakgebied
mean_Lifesciences <- mean_frame(numerieke_data[numerieke_data$Vakgebied == "Lifesciences", 1:13])
mean_Technisch <- mean_frame(numerieke_data[numerieke_data$Vakgebied == "Technisch", 1:13])
mean_Anders <- mean_frame(numerieke_data[numerieke_data$Vakgebied == "Anders", 1:13])
mean_Sociaal <- mean_frame(numerieke_data[numerieke_data$Vakgebied == "Sociaal", 1:13])
mean_Kunst <- mean_frame(numerieke_data[numerieke_data$Vakgebied == "Kunst", 1:13])
mean_Economisch <- mean_frame(numerieke_data[numerieke_data$Vakgebied == "Economisch", 1:13])


#Zet alle gemiddelden in een dataframe met de maximale- en minimale grens
df_mean_vakgebied <- rbind(max_min, mean_Lifesciences, mean_Technisch, mean_Anders, mean_Sociaal, mean_Kunst, mean_Economisch)

#Zet de correcte titels voor de rijen in de dataframe
rownames(df_mean_vakgebied) <- c("Max", 
                            "Min", 
                            "Lifesciences", 
                            "Technisch", 
                            "Anders", 
                            "Sociaal", 
                            "Kunst", 
                            "Economisch")

#Rond de waarden in de dataframe af
df_mean_vakgebied <- round_data(df_mean_vakgebied, 1)

#Verwijder de vakgebied kolom weer
numerieke_data <- numerieke_data[1:13]

#head(df_mean_vakgebied)

#Zet grafische parameters
op <- par(mar = c(1, 1, 1, 1))

js_radarchart(data= df_mean_vakgebied, color= c("cyan", "violet", "brown", "yellow", "black", "green"), title= "Gemiddeld Geluk Gesplitst Op Vakgebied")

#Maak een legenda voor de grafiek
legend(
  x = "right", 
  legend = c("Lifesciences", "Technisch", "Anders", "Sociaal", "Kunst", "Economisch"), 
  horiz = FALSE,
  bty = "n", 
  pch = 20 , 
  col = c("cyan", "violet", "brown", "yellow", "black", "green"),
  text.col = "black", 
  cex = 1, 
  pt.cex = 1.5
  )

par(op)
```
in figuur 7 zie je een radar chart van geluk gesplitst op vakgebied. Wat hier opvalt is dat de groep "Kunst" over het algemeen minder gelukkig is dan de rest van de groepen. Ook gebruiken ze meer drugs en alchohol dan de rest.\

Dit lijkt net als de "Anders" groep in de vorige radar chart. Misschien is er een relatie tussen de twee groepen. 


### Staat je Academische niveau in relatie met je geluk?

```{r, include=FALSE}
#Voeg de niveau kolom terug aan de dataframe
numerieke_data$Niveau <- Student_awn_data$Niveau

#Verander de namen van de waarden om het later makkelijker te maken
numerieke_data$Niveau[numerieke_data$Niveau == "Universiteit (University) Bachelor"] <- "Universiteit"

#Reken de gemiddelden van de individuen gesplitst op niveau
mean_MBO <- mean_frame(numerieke_data[numerieke_data$Niveau == "MBO", 1:13])
mean_HBO <- mean_frame(numerieke_data[numerieke_data$Niveau == "HBO", 1:13])
mean_Masters <- mean_frame(numerieke_data[numerieke_data$Niveau == "Masters", 1:13])
mean_Uni <- mean_frame(numerieke_data[numerieke_data$Niveau == "Universiteit", 1:13])

#Zet alle gemiddelden in een dataframe met de maximale- en minimale grens
df_mean_niveau <- rbind(max_min, mean_MBO, mean_HBO, mean_Masters, mean_Uni)

#Zet de correcte titels voor de rijen in de dataframe
rownames(df_mean_niveau) <- c("Max", "Min", "MBO", "HBO", "Masters", "Universiteit")

#Rond de waarden in de dataframe af
df_mean_niveau <- round_data(df_mean_niveau, 1)

#Verwijder de niveau kolom weer
numerieke_data <- numerieke_data[1:13]

#head(df_mean_niveau)
```

```{r, echo= FALSE}
op <- par(mar = c(1, 1, 1, 1))

js_radarchart(data= df_mean_niveau, color= c("red", "blue", "yellow", "green"), title= "Gemiddeld Geluk Gesplitst Op Niveau")

#Maak een legenda voor de grafiek
legend(
  x = "right", 
  legend = c("MBO", "HBO", "Masters", "Universiteit"), 
  horiz = FALSE,
  bty = "n", 
  pch = 20 , 
  col = c("red", "blue", "yellow", "green"),
  text.col = "black", 
  cex = 1, 
  pt.cex = 1.5
  )

par(op)
```
Hierboven zie je een radar chart van het gemiddeld geluk gesplitst op niveau. Het enige wat opvalt uit deze grafiek is dat mensen die studeren aan de universiteit over het algemeen iets gelukkiger zijn dan de rest van de groepen.


### cbs data

```{r, echo=FALSE}

cbs_data_geluk <- read_csv("../raw_data/cbs_data_geluk.csv")

colnames(cbs_data_geluk) <- c("Periode", "Tevredenheid_18_plus", "Tevredenheid_18_tot_25", "Geluk_18_plus", "Geluk_18_tot_25")
cbs_data_geluk <- cbs_data_geluk %>%
    mutate(Geluk_18_tot_25 = Geluk_18_tot_25 / 100)

cbs_geluk_18_tot_25 <- select(cbs_data_geluk, c(Periode, Geluk_18_tot_25))

p_cbs <- ggplot() + 
    geom_point(data = cbs_geluk_18_tot_25, aes(x=Periode, y=Geluk_18_tot_25), color = "blue", alpha = 0.6) +
    ylab("Geluk") +
    xlab("Tijd periode in jaren") +
  ggtitle("Gemiddeld geluk jong volwassenen") +
    labs(caption = "Figuur 8: Gemiddeld geluk jong volwassenen") +
    theme_minimal()

p_cbs
```

in figuur 8 is het gemiddelde geluk in jong volwassenen tussen 18 en 25 jaar. Er is te zien dat er een neerwaartse trend begint vanaf 2010 deze wordt steeds groter en in 2020 (waar ook de corona periode begon) was het geluk van de jongvolwassenen gemiddeld het laagste. Als we dit met onze data vergelijken zien we dat uit onze data blijkt dat de studenten gemideld ongelukkiger zijn. met een gemidelde score tussen de 6.3 en 6.7 terwijl deze van de jong volwassenen net onder 8.25 ligt.



# Discussie en Conclusies

## Conclusie

De data die wij verzameld hebben is niet genoeg om een antwoord te geven op de hypothese. Dit komt omdat er niet genoeg data is voor elke stad. De stad met het grootste aantal antwoorden is Groningen deze heeft echter ook maar 70 antwoorden dit is te zien in figuur 1. De 70 antwoorden zijn niet genoeg om met 95% zekerheid een antwoord te geven. Hierdoor zullen wij alleen naar factoren kunnen kijken zoals verschillen tussen de seksen in de stad Groningen. Hier kunnen we uit halen dat mannen het gelukkigste zijn en de anders sekse het ongelukkigste dit is te zien in figuur 4. Ook hebben wij gevonden dat er misschien een relatie zit tussen de studenten die een kunst opleiding volgen en bij de sekse "Anders"\ 
Verder is te zien dat studenten die uitwonend zijn over het algemeen aan de gelukkigere kant zitten dat is te zien in figuur 5. De data die verzameld is zegt ook dat de studenten in Groningen gemiddeld niet zeer gelukkig zijn. Dit is tevens een trend in de data die het cbs heeft gevonden dit is te zien in figuur 8. Hier is ook een neerwaartse trend te zien. Wat wij dus uit deze data kunnen halen is dat een student in de stad Groningen redelijk gelukkig is maar er is zeker ruimte voor verbetering. 

Deze data zal niet kunnen worden gebruikt in het werkveld. Het is niet genoeg om vertrouwen op de gegeven resultaten. Hierdoor is het een speculatieve data waardoor het niet betrouwbaar is.

## Discussie

De volgende keer moeten wij een betere manier verzinnen om de data te verzamelen. Wij hadden bijna, en voor Utrecht zelfs helemaal geen data. Door deze belemmering konden wij ons onderzoek niet goed uitvoeren. Dit zouden wij de volgende keer kunnen oplossen door directer naar de studenten te marketen. Wij kunnen dit oplossen door meerdere dagen per stad te besteden en fysiek studenten vragen om mee te doen met ons onderzoek. 



# Referenties

Een lijst van referenties wordt hier automatisch toegevoegd.
